<?xml version="1.0" encoding="UTF-8" ?>
<Module>
    <ModulePrefs title="Your App Name">
        <Require feature="rpc"/>
        <Require feature="views"/>
    </ModulePrefs>

    <Content type="html">
        <![CDATA[
            <!DOCTYPE html>
            <html>
                <head>
                    <meta charset="utf-8">

                    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
                    <script src="//plus.google.com/hangouts/_/api/v1/hangout.js"></script>
                    <script>
                        'use strict';

                        var postHangoutId = function(lessonId, hangoutId) {
                            var ajax = new XMLHttpRequest();

                            ajax.open('POST', 'https://codementor.io/api/lessons/' + lessonId + '/hangouts');
                            ajax.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                            ajax.send('hangouts_id=' + hangoutId);
                        };

                        gapi.hangout.onApiReady.add(function(event){
                            //event.isApiReady && postHangoutId(gapi.hangout.getStartData(), gapi.hangout.getHangoutUrl().split('/').pop());
                            event.isApiReady && $.post('https://codementor.io/api/lessons/' + gapi.hangout.getStartData() + '/hangouts', {hangouts_id: gapi.hangout.getHangoutUrl().split('/').pop()});
                        });
                    </script>
                </head>

                <body>
                    <h1>Hello Plunker!</h1>
                </body>
            </html>
        ]]>
    </Content>
</Module>
